%% Clear And Close
clc
clear all
close all

%% Variables
plsct = 1; %Select the number of Plots to Create
rnfit = 2; % Select the fit of Different kWh Samples
%% Create Data

fileName = 'senateEDD.csv';

Data=senateEDD1(fileName);
rowsData= size(Data,1);
colsData= size(Data,2);
DataMat = cell2mat(Data(2:rowsData,4:colsData));
rowsDataMat = size(DataMat,1);
colsDataMat = size(DataMat,2);

for n=1:rowsDataMat

    for c = 1:48
        cc= c/2;
        TimeHH(:,c)= cc;
        cm = c*30;
        if c == 1
            grad(n,c) = ((DataMat(n,c)-DataMat(n,c))/(30));
            const(n,c) = DataMat(n,c)-grad(n,c)*cm;
        else
            grad(n,c)=((DataMat(n,c)-DataMat(n,c-1))/(30));
            const(n,c)=DataMat(n,c)-grad(n,c)*cm;
        end
        for m = 1:30
            mm = (c-1)*30 + m;
            TimeMM(:,mm)= mm;
            DataMatmm(n,mm)=grad(n,c)*mm+const(n,c); % kWh Usage Per Half Hour with Minute by Minute Data Segments
            DataMatmm30(n,mm)=DataMatmm(n,mm)/30; % kWh Useage Per Minute
            livedata(n,mm)=2*(DataMatmm(n,mm)+randn/rnfit);
        end
        livedataav(n,c)=mean(livedata(n,mm-29:mm)); % Method to Check the Fit of Code
    end
end

   %      ylim([8 38]);
  for plsct
    yyaxis left
    plot(TimeMM(1,:),livedata(2,:))
    hold on
    plot(TimeMM(1,:),DataMatmm(2,:));
    xlim([0 1440]);
    yyaxis right
    plot(TimeMM(1,:),DataMatmm30(2,:));

    % Validate Code 
%     datasum = sum(DataMat(2,:));
%     datammsum = sum(DataMatmm30(2,:));
%     livesum = trapz(livedata(2,:))/60;
    